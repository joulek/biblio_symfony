{% extends 'base.html.twig' %}

{% block title %}Statistiques{% endblock %}

{% block body %}
<div class="container mt-4">

    <h1 class="mb-4">ðŸ“Š Statistiques gÃ©nÃ©rales</h1>

    <div class="row g-4">

        <div class="col-md-3">
            <div class="stat-card">
                <h3>{{ stats.livres }}</h3>
                <p>Livres</p>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card">
                <h3>{{ stats.utilisateurs }}</h3>
                <p>Utilisateurs</p>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card">
                <h3>{{ stats.emprunts }}</h3>
                <p>Total emprunts</p>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card">
                <h3>{{ stats.en_cours ?? stats.emprunts_en_cours }}</h3>
                <p>Emprunts en cours</p>
            </div>
        </div>

    </div>


    <hr class="my-5">

    <h3>ðŸ“ˆ Graphique statistiques</h3>
    <canvas id="statsChart" height="120"></canvas>

</div>
{% endblock %}

{% block javascripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const ctx = document.getElementById('statsChart');

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['Livres', 'Utilisateurs', 'Emprunts', 'En cours'],
        datasets: [{
            label: 'Statistiques',
            data: [
                {{ stats.livres }},
                {{ stats.utilisateurs }},
                {{ stats.emprunts }},
                {{ stats.en_cours ?? stats.emprunts_en_cours }}
            ],
            borderWidth: 2,
            backgroundColor: ['#4c0f1a', '#6f0f3a', '#a60f55', '#d41c6d']
        }]
    },
    options: {
        responsive: true,
        scales: { 
            y: { 
                beginAtZero: true,
                ticks: { stepSize: 1 }
            } 
        }
    }
});
</script>

<style>
.stat-card {
    background: #4c0f1a;
    color: white;
    padding: 25px;
    border-radius: 12px;
    text-align: center;
    font-weight: 600;
    box-shadow: 0 4px 14px rgba(0,0,0,0.15);
    transition: 0.3s;
}
.stat-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.22);
}
.stat-card h3 {
    font-size: 2.4rem;
    margin-bottom: 5px;
}
.stat-card p {
    margin: 0;
    font-size: 1rem;
    opacity: 0.85;
}
</style>

{% endblock %}
